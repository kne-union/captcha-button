(self.webpackChunk_kne_components_captcha_button=self.webpackChunk_kne_components_captcha_button||[]).push([[521],{1902:(e,t,r)=>{var n=r(4258),a=r(99086),o=r(50570);e.exports=function(e,t,r){return t===t?o(e,t,r):n(e,a,r)}},2899:(e,t,r)=>{var n=r(64579),a=r(2316),o=r(90931),i=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=u.test(e);return r||s.test(e)?c(e.slice(2),r?2:8):i.test(e)?NaN:+e}},3141:(e,t,r)=>{"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,u=[],s=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(u.push(n.value),u.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(t,{A:()=>a})},4258:e=>{e.exports=function(e,t,r,n){for(var a=e.length,o=r+(n?1:-1);n?o--:++o<a;)if(t(e[o],o,e))return o;return-1}},9211:(e,t,r)=>{var n=r(65472),a=r(11747),o=r(85506),i=r(52486),u=r(36928),s=r(18710),c=r(57517),l=r(26711),f=r(2316),d=r(45370);e.exports=function(e,t,r){var m=s(e),p=m||c(e)||d(e);if(t=i(t,4),null==r){var g=e&&e.constructor;r=p?m?new g:[]:f(e)&&l(g)?a(u(e)):{}}return(p?n:o)(e,(function(e,n,a){return t(r,e,n,a)})),r}},16735:e=>{e.exports=function(){}},17616:(e,t,r)=>{var n=r(59744),a=r(16735),o=r(76996),i=n&&1/o(new n([,-0]))[1]==1/0?function(e){return new n(e)}:a;e.exports=i},17952:e=>{e.exports=function(e,t){return e.has(t)}},20957:(e,t,r)=>{var n=r(49266),a=r(39463),o=r(55949),i=r(26926),u=r(35798),s=r(76996),c=n?n.prototype:void 0,l=c?c.valueOf:void 0;e.exports=function(e,t,r,n,c,f,d){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!f(new a(e),new a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var m=u;case"[object Set]":var p=1&n;if(m||(m=s),e.size!=t.size&&!p)return!1;var g=d.get(e);if(g)return g==t;n|=2,d.set(e,t);var v=i(m(e),m(t),n,c,f,d);return d.delete(e),v;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},22164:e=>{e.exports=function(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}},24018:(e,t,r)=>{var n=r(40506),a=r(71584),o=r(42947),i=r(12408);e.exports=function(e){return o(e)?n(i(e)):a(e)}},24753:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},25647:(e,t,r)=>{var n=r(90951);e.exports=function(e,t,r){return null==e?e:n(e,t,r)}},26926:(e,t,r)=>{var n=r(49036),a=r(24753),o=r(17952);e.exports=function(e,t,r,i,u,s){var c=1&r,l=e.length,f=t.length;if(l!=f&&!(c&&f>l))return!1;var d=s.get(e),m=s.get(t);if(d&&m)return d==t&&m==e;var p=-1,g=!0,v=2&r?new n:void 0;for(s.set(e,t),s.set(t,e);++p<l;){var h=e[p],y=t[p];if(i)var b=c?i(y,h,p,t,e,s):i(h,y,p,e,t,s);if(void 0!==b){if(b)continue;g=!1;break}if(v){if(!a(t,(function(e,t){if(!o(v,t)&&(h===e||u(h,e,r,i,s)))return v.push(t)}))){g=!1;break}}else if(h!==y&&!u(h,y,r,i,s)){g=!1;break}}return s.delete(e),s.delete(t),g}},27342:(e,t,r)=>{var n=r(49036),a=r(63948),o=r(22164),i=r(17952),u=r(17616),s=r(76996);e.exports=function(e,t,r){var c=-1,l=a,f=e.length,d=!0,m=[],p=m;if(r)d=!1,l=o;else if(f>=200){var g=t?null:u(e);if(g)return s(g);d=!1,l=i,p=new n}else p=t?[]:m;e:for(;++c<f;){var v=e[c],h=t?t(v):v;if(v=r||0!==v?v:0,d&&h===h){for(var y=p.length;y--;)if(p[y]===h)continue e;t&&p.push(h),m.push(v)}else l(p,h,r)||(p!==m&&p.push(h),m.push(v))}return m}},27497:(e,t,r)=>{var n=r(86657),a=r(49723);e.exports=function(e){return null==e?[]:n(e,a(e))}},33076:e=>{e.exports=function(e){return null==e}},33375:(e,t,r)=>{var n=r(34001),a=r(76003);e.exports=function e(t,r,o,i,u){return t===r||(null==t||null==r||!a(t)&&!a(r)?t!==t&&r!==r:n(t,r,o,i,e,u))}},34001:(e,t,r)=>{var n=r(62316),a=r(26926),o=r(20957),i=r(84462),u=r(74406),s=r(18710),c=r(57517),l=r(45370),f="[object Arguments]",d="[object Array]",m="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,g,v,h){var y=s(e),b=s(t),x=y?d:u(e),F=b?d:u(t),w=(x=x==f?m:x)==m,S=(F=F==f?m:F)==m,A=x==F;if(A&&c(e)){if(!c(t))return!1;y=!0,w=!1}if(A&&!w)return h||(h=new n),y||l(e)?a(e,t,r,g,v,h):o(e,t,x,r,g,v,h);if(!(1&r)){var I=w&&p.call(e,"__wrapped__"),E=S&&p.call(t,"__wrapped__");if(I||E){var V=I?e.value():e,M=E?t.value():t;return h||(h=new n),v(V,M,r,g,h)}}return!!A&&(h||(h=new n),i(e,t,r,g,v,h))}},35798:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},40506:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},46310:e=>{var t=Math.ceil,r=Math.max;e.exports=function(e,n,a,o){for(var i=-1,u=r(t((n-e)/(a||1)),0),s=Array(u);u--;)s[o?u:++i]=e,e+=a;return s}},49036:(e,t,r)=>{var n=r(20250),a=r(74101),o=r(54054);function i(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}i.prototype.add=i.prototype.push=a,i.prototype.has=o,e.exports=i},50531:(e,t,r)=>{var n=r(2316);e.exports=function(e){return e===e&&!n(e)}},50570:e=>{e.exports=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}},52486:(e,t,r)=>{var n=r(76526),a=r(74263),o=r(55045),i=r(18710),u=r(24018);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?i(e)?a(e[0],e[1]):n(e):u(e)}},54054:e=>{e.exports=function(e){return this.__data__.has(e)}},54159:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=i(e,o(r)))}return e}function o(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=i(t,r));return t}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},57325:(e,t,r)=>{var n=r(20907),a=0;e.exports=function(e){var t=++a;return n(e)+t}},60094:(e,t,r)=>{var n=r(85477)();e.exports=n},63948:(e,t,r)=>{var n=r(1902);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},64579:(e,t,r)=>{var n=r(78913),a=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(a,""):e}},66650:(e,t,r)=>{var n=r(62316),a=r(33375);e.exports=function(e,t,r,o){var i=r.length,u=i,s=!o;if(null==e)return!u;for(e=Object(e);i--;){var c=r[i];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<u;){var l=(c=r[i])[0],f=e[l],d=c[1];if(s&&c[2]){if(void 0===f&&!(l in e))return!1}else{var m=new n;if(o)var p=o(f,d,l,e,t,m);if(!(void 0===p?a(d,f,3,o,m):p))return!1}}return!0}},67523:(e,t,r)=>{"use strict";r.d(t,{_e:()=>Ie,y0:()=>ye,wk:()=>T,dG:()=>_e,bw:()=>Ce,Ay:()=>xe,Gk:()=>L,UI:()=>Pe,aW:()=>ke,dY:()=>le,Im:()=>k,hj:()=>_,V$:()=>De,IS:()=>be,xd:()=>Re,EC:()=>Ne,Mt:()=>Me,WZ:()=>J,xW:()=>J,dB:()=>Se,P4:()=>je,of:()=>Oe});var n=r(14888),a=r.n(n),o=r(27497),i=r.n(o),u=r(18710),s=r.n(u),c=r(92679),l=r.n(c),f=r(33227),d=r.n(f),m=r(33076),p=r.n(m),g=r(71406),v=r.n(g),h=r(9211),y=r.n(h),b=r(73075),x=r.n(b),F=r(25647),w=r.n(F),S=r(94922),A=r.n(S);const I=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))};var E=r(98171),V=r.n(E),M=r(78678),j=r(20775),O=r.n(j),N=r(60094),R=r.n(N),C=r(57325),P=r.n(C);function D(e,t,r){var n=this,a=(0,S.useRef)(null),o=(0,S.useRef)(0),i=(0,S.useRef)(null),u=(0,S.useRef)([]),s=(0,S.useRef)(),c=(0,S.useRef)(),l=(0,S.useRef)(e),f=(0,S.useRef)(!0);l.current=e;var d="undefined"!=typeof window,m=!t&&0!==t&&d;if("function"!=typeof e)throw new TypeError("Expected a function");t=+t||0;var p=!!(r=r||{}).leading,g=!("trailing"in r)||!!r.trailing,v="maxWait"in r,h="debounceOnServer"in r&&!!r.debounceOnServer,y=v?Math.max(+r.maxWait||0,t):null;(0,S.useEffect)((function(){return f.current=!0,function(){f.current=!1}}),[]);var b=(0,S.useMemo)((function(){var e=function(e){var t=u.current,r=s.current;return u.current=s.current=null,o.current=e,c.current=l.current.apply(r,t)},r=function(e,t){m&&cancelAnimationFrame(i.current),i.current=m?requestAnimationFrame(e):setTimeout(e,t)},b=function(e){if(!f.current)return!1;var r=e-a.current;return!a.current||r>=t||r<0||v&&e-o.current>=y},x=function(t){return i.current=null,g&&u.current?e(t):(u.current=s.current=null,c.current)},F=function e(){var n=Date.now();if(b(n))return x(n);if(f.current){var i=t-(n-a.current),u=v?Math.min(i,y-(n-o.current)):i;r(e,u)}},w=function(){if(d||h){var l=Date.now(),m=b(l);if(u.current=[].slice.call(arguments),s.current=n,a.current=l,m){if(!i.current&&f.current)return o.current=a.current,r(F,t),p?e(a.current):c.current;if(v)return r(F,t),e(a.current)}return i.current||r(F,t),c.current}};return w.cancel=function(){i.current&&(m?cancelAnimationFrame(i.current):clearTimeout(i.current)),o.current=0,u.current=a.current=s.current=i.current=null},w.isPending=function(){return!!i.current},w.flush=function(){return i.current?x(Date.now()):c.current},w}),[p,v,t,y,g,m,d,h]);return b}const _=e=>{if(a()(e)){const t=i()(e);return t.length>0&&t.some((e=>!!e))}return s()(e)?e.length>0:"number"===typeof e?!isNaN(e):!(void 0===e||null===e||""===e||0===e.length)},k=e=>!_(e),L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s()(e))return e.map((e=>L(e))).filter(_);if(a()(e)){const t={};return Object.keys(e).forEach((r=>{const n=L(e[r]);_(n)&&(t[r]=n)})),t}return e},T=(e,t)=>"string"===typeof e?e.replace("%s",t):e(t);var G;const z="PRE_INIT",$="INIT",U="INIT",W="PENDING",Z="PASS",B="ERROR";class Q{constructor(e){let{id:t,name:r,associations:n,formInterceptor:a,options:o}=e;this.id=t,this.name=r,this.formInterceptor=a,this.groupName=null,this.groupIndex=null,this.state=z,this.fieldRef=null,this.associations={fields:d()(n,"fields",[]).filter((e=>!!e.name)),callback:d()(n,"callback",(()=>{}))},this.validate={status:U},this.value=void 0,this.options=Object.assign({},o)}get isReady(){return this.state===$}get isPass(){return this.validate.status===Z}setInfo(e){let{groupName:t,groupIndex:r,label:n,rule:a,interceptor:o,noTrim:i,fieldRef:u,errMsg:s}=e;return this.groupName=t,this.groupIndex=r,this.label=n,this.rule=a,this.interceptor=o,this.noTrim=i,this.fieldRef=u,this.errMsg=s,this.state=$,this.path=Q.getFieldValuePath(this),this}getValueFromFormData(e){return Q.computedFieldValueFromFormData(this,e)}setFieldValue(e){return this.setValue(this.formInterceptor.input({value:e,interceptor:this.interceptor})),this}getFieldValue(){return this.formInterceptor.output({value:this.value,interceptor:this.interceptor})}getErrState(){return this.validate.status===Z?1:this.validate.status===B?2:this.validate.status===W?3:0}getErrMsg(){return T(this.errMsg||this.validate.msg||"",this.label)}setValidateStatus(e){let{status:t,msg:r="",validateData:n}=e;return this.validate={status:(e=>1===e?Z:2===e?B:U)(t),msg:r,validateData:Object.assign({},this.validate.validateData,n)},this}async runValidate(e,t){const r=await(async e=>{let{field:t,value:r,formRules:n,getFormData:a}=e;if("function"===typeof t.rule)return await t.rule(r,Object.assign({},{data:a()},{field:t}));if("object"===typeof t.rule&&t.rule instanceof RegExp)return{result:t.rule.test(r),errMsg:""};const o={};if("string"===typeof t.rule){const e=t.rule.split(" ").filter((e=>e.length>0));for(let i of e){let[e,...u]=i.split("-");const s=n[e.toUpperCase()];if("function"===typeof s){if("REQ"!==i&&!0!==n.REQ(r,...u,Object.assign({},{data:a()},{field:t})).result)return{result:!0,errMsg:"",data:o};const c=await s(r,...u,Object.assign({},{data:a()},{field:t}));if(Object.assign(o,{[e.toUpperCase()]:c.data}),!0!==c.result)return{result:!1,errMsg:c.errMsg,data:o}}else console.error("\u6821\u9a8c\u89c4\u5219".concat(i,"\u4e0d\u5728\u5f53\u524dform\u7684rules\u91cc\u9762\uff0c\u8bf7\u786e\u8ba4").concat(t.name,"\u7684\u6821\u9a8c\u89c4\u5219").concat(t.rule,"\u662f\u5426\u6b63\u786e"))}}return{result:!0,errMsg:"",data:o}})({field:this.clone(),value:this.value,formRules:e,getFormData:t});return this.validate={status:!0===r.result?Z:B,msg:r.errMsg,validateData:Object.assign({},r.data)},this}setValue(e){return this.value===e||(this.value=e,this.validate={status:U}),this}deleteValue(){return this.setValue(void 0),this}clone(){return v()(this)}}G=Q,Q.stateToError=x()((e=>Array.from(e.values()).filter((e=>d()(e,"validate.status")===B)).map((e=>Object.assign({},e.validate,{name:e.name,label:e.label,groupName:e.groupName,fieldRef:e.fieldRef,groupIndex:e.groupIndex,errMsg:e.getErrMsg()}))))),Q.findField=(e,t)=>t.id?e.get(t.id):t.groupName?Array.from(e.values()).find((e=>e.name===t.name&&e.groupName===t.groupName&&e.groupIndex===t.groupIndex)):Array.from(e.values()).find((e=>e.name===t.name)),Q.matchField=(e,t)=>Object.keys(t).filter((e=>!p()(t[e]))).every((r=>e[r]===t[r])),Q.matchFields=(e,t)=>{if(!t.groupName){const r=G.findField(e,t);return r?[r]:[]}return Array.from(e.values()).filter((e=>G.matchField(e,t)))},Q.matchAssociationFields=(e,t)=>Array.from(e.values()).filter((e=>e.id!==t.id&&(!(!e.associations.fields&&e.associations.fields.length>0)&&e.associations.fields.some((e=>G.matchField(t,e)))))),Q.getFieldValuePath=e=>e.groupName&&!p()(e.groupIndex)&&l()(e.groupName.split("."))===e.name?"".concat(e.groupName,'["').concat(e.groupIndex,'"]'):e.groupName&&!p()(e.groupIndex)?"".concat(e.groupName,'["').concat(e.groupIndex,'"].').concat(e.name):e.name,Q.computedFormDataFormState=x()((e=>y()(Array.from(e.values()),((e,t)=>{if(!t.name)return;const r=t.getFieldValue();w()(e,G.getFieldValuePath(t),r)}),{}))),Q.computedFieldValueFromFormData=x()(((e,t)=>d()(t,G.getFieldValuePath(e)))),Q.stateToIsPass=e=>Array.from(e.values()).every((e=>e.isPass));const H=(0,S.createContext)({}),{Provider:q,Consumer:Y}=H,J=()=>{const{openApiRef:e}=(0,S.useContext)(H);return(0,S.useMemo)((()=>({get formData(){return e.current.data},get formState(){return e.current.formState},get openApi(){return e.current},get isPass(){return e.current.isPass},get errors(){return e.current.errors},get emitter(){return e.current.emitter}})),[e])},K=e=>{let{openApi:t,children:r}=e;const n=(0,S.useRef)(t);return n.current=t,A().createElement(q,{value:{openApiRef:n}},r)},X=(0,S.createContext)({}),{Provider:ee,Consumer:te}=X,re=()=>(0,S.useContext)(X);function ne(){return ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ne.apply(null,arguments)}function ae(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}const oe=e=>({getField:(t,r)=>{let n=e.current.getFormState().get(t);if(n)return r(n.clone())},setFieldInfo:t=>e.current.setFormState((e=>{if(!e.get(t.id))return e;const r=new Map(e);return r.set(t.id,t),r}))}),ie=["id","defaultValue"],ue=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Promise((e=>setTimeout((()=>{e(...t)}),0)))},se=(e,t)=>"".concat(e||"root","@").concat(t),ce=e=>{let{children:t}=e;const r=re(),n=(0,S.useRef)(r);return n.current=r,(0,S.useEffect)((()=>{const{emitter:e,setFormIsMount:t}=n.current;return t(!0),e.emit("form:mount"),()=>{e.emit("form:unmount")}}),[]),(0,S.useEffect)((()=>{const{emitter:e}=n.current;return e.addListener("form:field:add",(e=>t=>{let{id:r,name:n,associations:a}=t;const{setFormState:o,interceptor:i,emitter:u}=e.current;o((e=>{const t=new Map(e);return t.set(r,new Q({id:r,name:n,formInterceptor:i,associations:a})),t})),u.emit("form-field:mount:".concat(r))})(n)),e.addListener("form:field:change",(e=>async t=>{let{id:r,defaultValue:n}=t,a=ae(t,ie);const{setFormState:o,initFormData:i,emitter:u}=e.current,{getField:s}=oe(e);s(r,(async e=>{e.setInfo(a),(()=>{if(void 0!==e.value)return;const t=e.getValueFromFormData(i);t?e.setFieldValue(t):void 0!==n&&e.setFieldValue(n)})(),o((t=>{const n=new Map(t);return n.set(r,e),n})),void 0!==e.value&&u.emit("form-field:input:".concat(e.id),{value:e.value}),u.emit("form:field:ready",e)}))})(n)),e.addListener("form:field:remove",(e=>t=>{let{id:r}=t;const{setFormState:n}=e.current;n((e=>{const t=new Map(e);return t.delete(r),t}))})(n)),e.addListener("form:validate",(e=>()=>{const{formState:t,emitter:r}=e.current;Array.from(t.values()).forEach((e=>{r.emit("form-field:validate:".concat(e.id))}))})(n)),e.addListener("form:reset",(e=>()=>{const{getFormState:t,emitter:r}=e.current;Array.from(t().values()).forEach((e=>{r.emit("form-field:input:".concat(e.id),{value:void 0})}))})(n)),e.addListener("form:set-data",(e=>async t=>{let{data:r,runValidate:n=!0}=t;const{setFormState:a,emitter:o}=e.current;a((e=>{const t=new Map;return Array.from(e.values()).forEach((e=>{if(!e.isReady)return;const n=e.clone();n.setFieldValue(n.getValueFromFormData(r)),t.set(e.id,n),o.emit("form-field:input:".concat(e.id),{value:n.value})})),t})),await ue(),n&&Array.from(e.current.formState.values()).forEach((e=>{o.emit("form-field:validate:".concat(e.id))}))})(n)),e.addListener("form:set-fields",(e=>async t=>{let{data:r,runValidate:n=!0}=t;const{emitter:a,getFormState:o}=e.current;Array.isArray(r)||(r=[r]);const{setFieldInfo:i,getField:u}=oe(e),s=[];r.forEach((e=>{const{name:t,groupName:r,groupIndex:n,value:c,validate:l}=Object.assign({},e),f=Q.matchFields(o(),{name:t,groupName:r,groupIndex:n});f&&f.length>0&&f.forEach((r=>{r.isReady&&(e.hasOwnProperty("value")&&a.emit("form-field:input:".concat(r.id),{value:p()(t)?d()(c,r.name):c}),u(r.id,(e=>{l?e.setValidateStatus(l):s.push(e.id),i(e)})))}))})),n&&s.forEach((e=>{a.emit("form-field:validate:".concat(e))}))})(n)),e.addListener("form:submit",(e=>async function(){const{task:t,emitter:r,noFilter:n,onError:a,onPrevSubmit:o,onSubmit:i,onComplete:u}=e.current;e.current.getFormState().forEach((e=>{r.emit("form-field:validate:".concat(e.id))}));let s=[],c=!1,l={};for(var f=arguments.length,d=new Array(f),m=0;m<f;m++)d[m]=arguments[m];try{if(await t.target,c=Q.stateToIsPass(e.current.getFormState()),c){const t=Q.computedFormDataFormState(e.current.getFormState());if(l=!0===n?t:L(t),r.emit("form:prev-submit",l,...d),o&&!1===await o(l,...d))return r.emit("form:prev-submit:error"),!1;i&&await i(l,...d),r.emit("form:submit:success",l,...d)}else s=Q.stateToError(e.current.getFormState()),r.emit("form:submit:error",s),a&&await a(s,...d)}catch(p){console.error(p),r.emit("form:error",s,...d,p),a&&a(s,...d,p)}r.emit("form:submit:complete",{formData:l,isPass:c,errors:s}),u&&u({formData:l,isPass:c,errors:s})})(n)),e.addListener("form-group:change",(e=>t=>{let{parentId:r,name:n,list:a}=t;const{setGroup:o}=e.current;o((e=>{const t=Object.assign({},e);return t[se(r,n)]=a.slice(0),t}))})(n)),e.addListener("form-group:remove",(e=>t=>{let{parentId:r,name:n}=t;const{setGroup:a}=e.current;a((e=>{const t=Object.assign({},e),a=se(r,n);if(t[a])return delete t[a],t}))})(n)),()=>{e.removeAllListeners()}}),[]),t},le={input:[],output:[]};le.input.use=(e,t)=>le.input.push({name:e,exec:t}),le.output.use=(e,t)=>le.output.push({name:e,exec:t});const fe=le,de=(e,t,r)=>{Array.isArray(r)||(r=[r]);const n=V()(fe[t].concat(d()(e,t,[])).filter((e=>{let{name:t}=e;return r.indexOf(t)>-1})).reverse(),(e=>{let{name:t}=e;return t}));return 0===n.length?e=>e:I(...n.map((e=>{let{exec:t}=e;return t})))},me="PENDING",pe="COMPLETE";class ge{constructor(e){let{id:t,runner:r}=e;this.id=t,this.isCancel=!1,this.target=Promise.race([Promise.resolve(r()),new Promise((e=>{this.resolve=e}))])}cancel(){this.isCancel||(this.isCancel=!0,this.resolve(...arguments))}}class ve{constructor(e){let{onChange:t}=e;this.list=new Map,this.onChange=t}get isComplete(){return 0===this.list.size}async append(e,t){const r=new ge({id:e,runner:t});return this.expire(e),this.list.set(e,r),r.target.then((()=>{this.list.delete(e),this.onChange()})),this.onChange(),r.target}expire(e){const t=this.list.get(e);return t&&(t.cancel(),this.list.delete(e)),this}}const he=()=>{const[e,t]=(0,S.useState)(pe),r=(0,S.useRef)(new ve({onChange(){t(this.isComplete?pe:me)}}));return{state:e,append:(e,t)=>r.current.append(e,t),expire:e=>r.current.expire(e),get target(){return ue().then((()=>Promise.all(Array.from(r.current.list.values()).map((e=>e.target))))).then(ue)}}},ye={REQ:function(e){return{result:_(e),errMsg:""}},TEL:function(e){return{result:/^1[0-9]{10}$/.test(e),errMsg:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u624b\u673a\u53f7"}},EMAIL:function(e){return{result:/^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e),errMsg:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u90ae\u7bb1"}},LEN:function(e,t,r){return e=e.toString(),r===t&&e.length!==Number(r)?{result:!1,errMsg:"%s\u957f\u5ea6\u5fc5\u987b\u7b49\u4e8e".concat(r)}:e.length<t?{result:!1,errMsg:"%s\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e".concat(t)}:r&&e.length>r?{result:!1,errMsg:"%s\u957f\u5ea6\u5fc5\u987b\u5c0f\u4e8e".concat(r)}:{result:!0}}},be=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(ye,e)},xe=(0,S.forwardRef)(((e,t)=>{let{data:r,rules:n,interceptors:a,debug:o,noFilter:i,onPrevSubmit:u,onSubmit:s,onError:c,onFormDataChange:l,children:f}=e;const[d,m]=(0,S.useState)(new Map),p=(0,S.useRef)(d),[g,v]=(0,S.useState)(!1),h=he(),y=O()({debug:o,name:"react-form3"}),{group:b,setGroup:x}=(()=>{const[e,t]=(0,S.useState)(new Map);return{group:e,setGroup:t}})(),F=(e=>{let{formStateRef:t,emitter:r}=e;return(0,S.useMemo)((()=>({emitter:r,submit:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.emit("form:submit",t)},get isPass(){return Q.stateToIsPass(t.current)},get formState(){return new Map(t.current)},get data(){return Q.computedFormDataFormState(t.current)},set data(e){r.emit("form:set-data",{data:e})},get errors(){return Q.stateToError(t.current)},reset(){r.emit("form:reset")},onReady(e){r.addListener("form:mount",(()=>{e&&e()}))},onDestroy(e){r.addListener("form:unmount",(()=>{e&&e()}))},validateField(e){let{name:n,groupName:a,groupIndex:o}=e;const i=Q.findField(t.current,{name:n,groupName:a,groupIndex:o});i&&r.emit("form-field:validate:".concat(i.id))},validateAll(){r.emit("form:validate")},setFormData:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r.emit("form:set-data",{data:e,runValidate:t})},getFormData:()=>Q.computedFormDataFormState(t.current),getField(e){let{name:r,groupName:n,groupIndex:a}=e;return Q.findField(t.current,{name:r,groupName:n,groupIndex:a})},getFields(e){let{name:r,groupName:n,groupIndex:a}=e;return Q.matchFields(t.current,{name:r,groupName:n,groupIndex:a})},setFieldValidate(e){let{name:t,validate:n,groupName:a,groupIndex:o}=e;n?r.emit("form:set-fields",{data:{name:t,groupName:a,groupIndex:o,validate:n}}):console.error("\u5fc5\u987b\u8bbe\u7f6evalidate\u53c2\u6570")},setField(e,t){r.emit("form:set-fields",Object.assign({},t,{data:e}))},setFields(e,t){r.emit("form:set-fields",Object.assign({},t,{data:e}))},setFieldValue(e,t,n){let{name:a,groupName:o,groupIndex:i,validate:u}=e;r.emit("form:set-fields",Object.assign({},n,{data:{name:a,groupName:o,groupIndex:i,value:t,validate:u}}))}})),[t,r])})({emitter:y,formStateRef:p}),w=(e=>{let{interceptors:t}=e;return{input:(0,M.A)((e=>{let{value:r,interceptor:n}=e;return de(t,"input",n)(r)})),output:(0,M.A)((e=>{let{value:r,interceptor:n}=e;return de(t,"output",n)(r)}))}})({interceptors:a});return(0,S.useImperativeHandle)(t,(()=>F),[F]),A().createElement(ee,{value:{emitter:y,openApi:F,task:h,formState:d,getFormState:()=>p.current,setFormState(e){const t="function"===typeof e?e(p.current):e;return p.current=t,m(t),t},formIsMount:g,setFormIsMount:v,group:b,setGroup:x,initFormData:Object.assign({},r),rules:Object.assign({},ye,n),interceptor:w,debug:o,noFilter:i,onPrevSubmit:u,onSubmit:s,onError:c,onFormDataChange:l}},A().createElement(K,{openApi:F},A().createElement(ce,null,f)))})),Fe=(0,S.createContext)({id:"root"}),{Provider:we}=Fe,Se=()=>(0,S.useContext)(Fe),Ae=e=>{let{id:t,name:r,children:n,defaultValue:a}=e;const{group:o}=re(),{id:i,index:u,name:s}=Se(),c=(0,S.useMemo)((()=>d()(o,se(i,r),[]).findIndex((e=>e.id===t))),[t,i,o,r]),l=(0,S.useMemo)((()=>c>-1&&s?"".concat(s,"[").concat(u,"].").concat(r):r),[s,r,c,u]);return A().createElement(we,{value:{id:t,name:l,group:o,index:c,defaultValue:a}},n({id:t,name:l,group:o,index:c}))},Ie=(0,S.forwardRef)(((e,t)=>{let{name:r,defaultLength:n=1,empty:a,reverseOrder:o=!0,children:i}=e;const[u,s]=(0,S.useState)([]),c=(0,S.useRef)(u);c.current=u;const{initFormData:l,emitter:f}=re(),{id:m,name:p,index:g}=Se(),v=(0,S.useMemo)((()=>g>-1&&p?"".concat(p,"[").concat(g,"]"):""),[p,g]),h=v?"".concat(v,".").concat(r):r,y=e=>Object.assign({},e,{id:m?P()(m+"-"):P()()}),b=(0,M.A)((e=>{let{groupName:t,name:r}=e;const a=e=>{const t=Number.isInteger(n)&&n>0&&!(Array.isArray(e)&&e.length>=n)?R()(0,n).map((e=>c.current[e]||y())):Array.isArray(e)?e.map(((e,t)=>c.current[t]||y({defaultValue:e}))):[];s(t)};a(d()(l,t?"".concat(t,".").concat(r):r));const o=f.addListener("form:set-data",(e=>{let{data:n}=e;a(d()(n,t?"".concat(t,".").concat(r):r))}));return()=>{o.remove()}}));(0,S.useEffect)((()=>{f.emit("form-group:change",{parentId:m,name:r,list:u})}),[u,m,r,f]),(0,S.useEffect)((()=>()=>{f.emit("form-group:remove",{parentId:m,name:r})}),[m,r]),(0,S.useEffect)((()=>b({groupName:v,name:r})),[v,r]);const x=(0,M.A)((e=>{const{isUnshift:t,defaultValue:r}=Object.assign({isUnshift:!1},e);s((e=>{if(0===e.length)return[{id:P()(m)}];const n=e.slice(0);return n[t?"unshift":"push"](y({defaultValue:r})),n}))})),F=(0,M.A)((e=>{s((t=>{const r=t.findIndex((t=>t.id===e)),n=d()(l,h);Array.isArray(n)&&n.splice(r,1);const a=t.slice(0);return a.splice(r,1),a}))}));return(0,S.useImperativeHandle)(t,(()=>({onAdd:x,onRemove:F}))),0===u.length?a:(o?u.slice(0).reverse():u).map((e=>{let{id:t,defaultValue:n}=e;return A().createElement(Ae,{key:t,id:t,name:r,defaultValue:n},(e=>{let{index:r}=e;return i({id:t,index:r,length:u.length,onAdd:x,onRemove:()=>F(t)})}))}))})),Ee=(e,t)=>{if((e=>window.Event&&(e instanceof window.Event||d()(e,"nativeEvent")instanceof window.Event||"function"===typeof d()(e,"preventDefault")))(e)){if(void 0===t)switch(e.target.type){case"checkbox":case"radio":t=e.target.checked;break;default:t=e.target.value}}else t=e;return t},Ve=["name","rule","label","interceptor","associations","noTrim","debounce","onChange","defaultValue","errMsg"],Me=e=>{let{name:t,rule:r,label:n,interceptor:a,associations:o,noTrim:i,debounce:u=0,onChange:s,defaultValue:c,errMsg:l}=e,f=ae(e,Ve);const m=(0,S.useId)(),{index:p,name:g,defaultValue:v}=Se(),{formState:h}=re(),[y,b]=(0,S.useState)({}),x=(e=>{let{name:t,rule:r,label:n,interceptor:a,associations:o,noTrim:i,defaultValue:u,id:s,groupName:c,groupIndex:l,errMsg:f}=e;const[d,m]=(0,S.useState)(!1),p=(0,S.useRef)(null),{formIsMount:g,emitter:v}=re(),h=(0,S.useRef)(o);return(0,S.useEffect)((()=>{let e=!1;return g&&(e=!0,m(!0),v.emit("form:field:add",{name:t,associations:h.current,id:s})),()=>{e&&v.emit("form:field:remove",{id:s})}}),[g,v,t,s]),(0,S.useEffect)((()=>{d&&-1!==l&&v.emit("form:field:change",{name:t,rule:r,label:n,interceptor:a,noTrim:i,id:s,groupName:c,groupIndex:l,defaultValue:u,fieldRef:p,errMsg:f})}),[d,v,t,r,n,a,i,s,c,l,u,p,f]),p})({name:t,rule:r,label:n,interceptor:a,associations:{fields:d()(o,"fields",[]),callback:function(){b(Object.assign({},null==o?void 0:o.callback(...arguments)))}},noTrim:i,defaultValue:d()(v,t)||c,id:m,groupName:g,groupIndex:p,errMsg:l}),{validate:F,isValueChanged:w,dataChange:A,value:I}=(e=>{let{id:t,defaultValue:r,onChange:n,time:a}=e;const o=re(),{formIsMount:i}=o,u=(0,S.useRef)(o);u.current=o;const[s,c]=(0,S.useState)(!1),[l,f]=(0,S.useState)(r);(0,S.useEffect)((()=>{if(!i)return;const{getField:e,setFieldInfo:r}=oe(u),{emitter:n}=u.current,a=[n.addListener("form-field:input:".concat(t),(a=>{let{value:o}=a;f(o),c(!0),e(t,(async e=>{e.setValue(o),r(e),void 0!==e.getFieldValue()&&(n.emit("form:field:set-value",{id:t,value:e.getFieldValue(),path:e.path}),n.emit("form-field:associations:".concat(t)))}))})),n.addListener("form-field:format:".concat(t),(r=>{let{format:a}=r;e(t,(e=>{const r=a(e.value);e.value!==r&&n.emit("form-field:input:".concat(t),{value:r})}))})),n.addListener("form-field:validate:".concat(t),(async()=>{const{rules:a,task:o}=u.current;await o.append(t,(async()=>{e(t,(async e=>{e.setValidateStatus({status:W}),r(e)})),e(t,(e=>{!0!==e.noTrim&&"string"===typeof e.value&&n.emit("form-field:format:".concat(t),{format:e=>e.trim()})})),e(t,(async e=>{await e.runValidate(a,(()=>Q.computedFormDataFormState(u.current.getFormState()))),r(e),n.emit("form-field:validate:complete:".concat(t),{validate:e.validate})}))}))})),n.addListener("form-field:associations:".concat(t),(async()=>{const{getFormState:r,openApi:a}=u.current;e(t,(e=>{Q.matchAssociationFields(r(),e).forEach((t=>{var r;n.emit("form-field:associations:callback",{target:t,origin:e}),null==(r=t.associations)||r.callback({target:t,origin:e,openApi:a})}))}))}))];return()=>{a.forEach((e=>{e.remove()}))}}),[i]);const d=(0,M.A)((function(){n&&n(...arguments);const{emitter:e}=u.current,r=Ee(...arguments);e.emit("form-field:input:".concat(t),{value:r})})),m=(0,M.A)((()=>{const{emitter:e}=u.current;e.emit("form-field:validate:".concat(t))})),p=D(m,a),g=p.cancel;return(0,S.useEffect)((()=>{const{emitter:e}=u.current,t=e.addListener("form:reset",g);return()=>{t&&t.remove()}}),[g]),{isValueChanged:s,value:l,dataChange:d,validate:a?p:m}})({id:m,time:u,onChange:s}),E=h.get(m),V=ne({},f,{id:m,name:t,label:n,value:I,fieldRef:x,formData:Q.computedFormDataFormState(h),formState:h,rule:r,groupName:g,groupIndex:p,onChange:A,isValueChanged:w,triggerValidate:F,associationOptions:y});return E?Object.assign({},V,{value:I,errState:E.getErrState(),errMsg:E.getErrMsg()}):V},je=()=>{const{emitter:e}=re();return{onClick:(0,S.useCallback)((()=>{e.emit("form:reset")}),[e])}},Oe=e=>{const[t,r]=(0,S.useState)(!1),{isPass:n,emitter:a}=re(),{onClick:o}=Object.assign({},e);return(0,S.useEffect)((()=>{const e=a.addListener("form:submit:complete",(()=>{r(!1)}));return()=>{e&&e.remove()}}),[a]),{isLoading:t,isPass:n,onClick:(0,S.useCallback)((async function(){r(!0);try{await ue();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=o&&await o(...t);a.emit("form:submit",r||t)}catch(i){console.error(i)}}),[a,r])}},Ne=Q.stateToIsPass,Re=Q.stateToError,Ce=Q.computedFormDataFormState,Pe=Q.findField,De=Q.matchFields,_e=Q.computedFieldValueFromFormData,ke={isNotEmpty:_,isEmpty:k,filterEmpty:L,compileErrMsg:T,stateToIsPass:Ne,stateToError:Re,computedFormDataFormState:Ce,findField:Pe,matchFields:De,computedFieldValueFromFormData:_e}},68965:(e,t,r)=>{var n=r(2899),a=1/0;e.exports=function(e){return e?(e=n(e))===a||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},71392:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},71406:(e,t,r)=>{var n=r(28566);e.exports=function(e){return n(e,4)}},71584:(e,t,r)=>{var n=r(41987);e.exports=function(e){return function(t){return n(t,e)}}},72111:(e,t,r)=>{var n=r(50531),a=r(49723);e.exports=function(e){for(var t=a(e),r=t.length;r--;){var o=t[r],i=e[o];t[r]=[o,i,n(i)]}return t}},74101:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},74263:(e,t,r)=>{var n=r(33375),a=r(33227),o=r(23052),i=r(42947),u=r(50531),s=r(71392),c=r(12408);e.exports=function(e,t){return i(e)&&u(t)?s(c(e),t):function(r){var i=a(r,e);return void 0===i&&i===t?o(r,e):n(t,i,3)}}},76526:(e,t,r)=>{var n=r(66650),a=r(72111),o=r(71392);e.exports=function(e){var t=a(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},76996:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},78678:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(94922);const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(0,n.useRef)(e);return t||(r.current=e),(0,n.useCallback)((function(){return r.current&&r.current(...arguments)}),[])}},78913:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},84462:(e,t,r)=>{var n=r(70633),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,o,i,u){var s=1&r,c=n(e),l=c.length;if(l!=n(t).length&&!s)return!1;for(var f=l;f--;){var d=c[f];if(!(s?d in t:a.call(t,d)))return!1}var m=u.get(e),p=u.get(t);if(m&&p)return m==t&&p==e;var g=!0;u.set(e,t),u.set(t,e);for(var v=s;++f<l;){var h=e[d=c[f]],y=t[d];if(o)var b=s?o(y,h,d,t,e,u):o(h,y,d,e,t,u);if(!(void 0===b?h===y||i(h,y,r,o,u):b)){g=!1;break}v||(v="constructor"==d)}if(g&&!v){var x=e.constructor,F=t.constructor;x==F||!("constructor"in e)||!("constructor"in t)||"function"==typeof x&&x instanceof x&&"function"==typeof F&&F instanceof F||(g=!1)}return u.delete(e),u.delete(t),g}},85477:(e,t,r)=>{var n=r(46310),a=r(54855),o=r(68965);e.exports=function(e){return function(t,r,i){return i&&"number"!=typeof i&&a(t,r,i)&&(r=i=void 0),t=o(t),void 0===r?(r=t,t=0):r=o(r),i=void 0===i?t<r?1:-1:o(i),n(t,r,i,e)}}},85506:(e,t,r)=>{var n=r(38932),a=r(49723);e.exports=function(e,t){return e&&n(e,t,a)}},86657:(e,t,r)=>{var n=r(91959);e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},98171:(e,t,r)=>{var n=r(52486),a=r(27342);e.exports=function(e,t){return e&&e.length?a(e,n(t,2)):[]}},99086:e=>{e.exports=function(e){return e!==e}}}]);
//# sourceMappingURL=521.aeaa51f1.chunk.js.map